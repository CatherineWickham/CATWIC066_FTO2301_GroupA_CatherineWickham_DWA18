import{p as H,i as le,c as m,r as R,a as W,b as F,d as ge,s as E,o as oe,e as _e,f as Me,h as Re,j as Ee,k as $e,l as he,m as we,n as Z,q as be,t as ae,u as s,_ as Se,v as Ve,w as $,x as X,y as d,z as G,A as z,B,C as ue,D as x,E as De,F as K,G as He,H as Ue,I as qe,J as Ne,K as Pe,L as I,M as U,N as Oe,O as We,P as je,Q as Fe}from"./index-60f7ff30.js";import{u as Ie,a as xe,V as Ke,b as Ge,c as ce}from"./VMenu-ec599dc0.js";import{u as Ye,m as Ze,a as se,b as Xe,c as Je,d as Qe,e as et,f as tt,g as ke,h as at,i as lt,j as ot,k as st,l as nt,n as rt,o as it,p as J,V as ut,q as C,r as de,s as ve,t as ct}from"./VCard-ba4fbd38.js";import{m as dt,V as me}from"./VToolbar-d540fa48.js";import{V as fe}from"./VTextField-bcce73b8.js";import{V as pe}from"./VDialog-51d6d80e.js";const Y=Symbol.for("vuetify:layout"),Ce=Symbol.for("vuetify:layout-item"),ye=1e3,vt=H({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout"),mt=H({name:{type:String},order:{type:[Number,String],default:0},absolute:Boolean},"layout-item");function ft(){const e=le(Y);if(!e)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:e.getLayoutItem,mainRect:e.mainRect,mainStyles:e.mainStyles}}function pt(e){const l=le(Y);if(!l)throw new Error("[Vuetify] Could not find injected layout");const o=e.id??`layout-item-${Re()}`,n=ge("useLayoutItem");_e(Ce,{id:o});const a=E(!1);Ee(()=>a.value=!0),$e(()=>a.value=!1);const{layoutItemStyles:t,layoutItemScrimStyles:c}=l.register(n,{...e,active:m(()=>a.value?!1:e.active.value),id:o});return he(()=>l.unregister(o)),{layoutItemStyles:t,layoutRect:l.layoutRect,layoutItemScrimStyles:c}}const yt=(e,l,o,n)=>{let a={top:0,left:0,right:0,bottom:0};const t=[{id:"",layer:{...a}}];for(const c of e){const v=l.get(c),h=o.get(c),w=n.get(c);if(!v||!h||!w)continue;const f={...a,[v.value]:parseInt(a[v.value],10)+(w.value?parseInt(h.value,10):0)};t.push({id:c,layer:f}),a=f}return t};function gt(e){const l=le(Y,null),o=m(()=>l?l.rootZIndex.value-100:ye),n=R([]),a=W(new Map),t=W(new Map),c=W(new Map),v=W(new Map),h=W(new Map),{resizeRef:w,contentRect:f}=Ye(),L=m(()=>{const g=new Map,k=e.overlaps??[];for(const y of k.filter(P=>P.includes(":"))){const[P,b]=y.split(":");if(!n.value.includes(P)||!n.value.includes(b))continue;const A=a.get(P),D=a.get(b),q=t.get(P),N=t.get(b);!A||!D||!q||!N||(g.set(b,{position:A.value,amount:parseInt(q.value,10)}),g.set(P,{position:D.value,amount:-parseInt(N.value,10)}))}return g}),S=m(()=>{const g=[...new Set([...c.values()].map(y=>y.value))].sort((y,P)=>y-P),k=[];for(const y of g){const P=n.value.filter(b=>{var A;return((A=c.get(b))==null?void 0:A.value)===y});k.push(...P)}return yt(k,a,t,v)}),_=m(()=>!Array.from(h.values()).some(g=>g.value)),V=m(()=>S.value[S.value.length-1].layer),p=m(()=>({"--v-layout-left":F(V.value.left),"--v-layout-right":F(V.value.right),"--v-layout-top":F(V.value.top),"--v-layout-bottom":F(V.value.bottom),..._.value?void 0:{transition:"none"}})),i=m(()=>S.value.slice(1).map((g,k)=>{let{id:y}=g;const{layer:P}=S.value[k],b=t.get(y),A=a.get(y);return{id:y,...P,size:Number(b.value),position:A.value}})),u=g=>i.value.find(k=>k.id===g),r=ge("createLayout"),M=E(!1);oe(()=>{M.value=!0}),_e(Y,{register:(g,k)=>{let{id:y,order:P,position:b,layoutSize:A,elementSize:D,active:q,disableTransitions:N,absolute:Te}=k;c.set(y,P),a.set(y,b),t.set(y,A),v.set(y,q),N&&h.set(y,N);const ne=Me(Ce,r==null?void 0:r.vnode).indexOf(g);ne>-1?n.value.splice(ne,0,y):n.value.push(y);const re=m(()=>i.value.findIndex(O=>O.id===y)),Q=m(()=>o.value+S.value.length*2-re.value*2),Be=m(()=>{const O=b.value==="left"||b.value==="right",ee=b.value==="right",ze=b.value==="bottom",ie={[b.value]:0,zIndex:Q.value,transform:`translate${O?"X":"Y"}(${(q.value?0:-110)*(ee||ze?-1:1)}%)`,position:Te.value||o.value!==ye?"absolute":"fixed",..._.value?void 0:{transition:"none"}};if(!M.value)return ie;const T=i.value[re.value];if(!T)throw new Error(`[Vuetify] Could not find layout item "${y}"`);const te=L.value.get(y);return te&&(T[te.position]+=te.amount),{...ie,height:O?`calc(100% - ${T.top}px - ${T.bottom}px)`:D.value?`${D.value}px`:void 0,left:ee?void 0:`${T.left}px`,right:ee?`${T.right}px`:void 0,top:b.value!=="bottom"?`${T.top}px`:void 0,bottom:b.value!=="top"?`${T.bottom}px`:void 0,width:O?D.value?`${D.value}px`:void 0:`calc(100% - ${T.left}px - ${T.right}px)`}}),Ae=m(()=>({zIndex:Q.value-1}));return{layoutItemStyles:Be,layoutItemScrimStyles:Ae,zIndex:Q}},unregister:g=>{c.delete(g),a.delete(g),t.delete(g),v.delete(g),h.delete(g),n.value=n.value.filter(k=>k!==g)},mainRect:V,mainStyles:p,getLayoutItem:u,items:i,layoutRect:f,rootZIndex:o});const j=m(()=>["v-layout",{"v-layout--full-height":e.fullHeight}]),Le=m(()=>({zIndex:o.value,position:l?"relative":void 0,overflow:l?"hidden":void 0}));return{layoutClasses:j,layoutStyles:Le,getLayoutItem:u,items:i,layoutRect:f,layoutRef:w}}const _t=H({color:String,...Ze(),...se(),...Xe(),...Je(),...Qe(),...et(),...tt(),...ke(),...we()},"VSheet"),ht=Z()({name:"VSheet",props:_t(),setup(e,l){let{slots:o}=l;const{themeClasses:n}=be(e),{backgroundColorClasses:a,backgroundColorStyles:t}=at(ae(e,"color")),{borderClasses:c}=lt(e),{dimensionStyles:v}=ot(e),{elevationClasses:h}=st(e),{locationStyles:w}=nt(e),{positionClasses:f}=rt(e),{roundedClasses:L}=it(e);return J(()=>s(e.tag,{class:["v-sheet",n.value,a.value,c.value,h.value,f.value,L.value,e.class],style:[t.value,v.value,w.value,e.style]},o)),{}}}),wt=["src"],bt={class:"playingInfo"},St={__name:"AudioPlayer",setup(e){const{currentlyPlaying:l}=Ve(Ie());let o=0;const n=t=>{t.target.currentTime=l.value.timePlayed,o++},a=async t=>{const c=t.target.currentTime;l.value.timePlayed=Math.floor(c);const v=await x.auth.getSession();await x.from("favorites").update({time_played:l.value.timePlayed}).eq("user_email",v.data.session.user.email).eq("showId",l.value.showId).eq("season",l.value.season).eq("episode",l.value.episode)};return(t,c)=>($(),X(ht,{class:"audioContainer"},{default:d(()=>[($(),G("audio",{controls:"",onLoadstart:n,onPause:a,onPlay:c[0]||(c[0]=(...v)=>t.toggleIsPlaying&&t.toggleIsPlaying(...v)),src:z(l).file,key:z(o)},null,40,wt)),B("div",bt,[B("h4",null,ue(z(l).episodeTitle),1),B("h5",null,ue(z(l).showTitle),1)])]),_:1}))}},Vt=Se(St,[["__scopeId","data-v-f0d4573f"]]),Pt={__name:"AppFooter",setup(e){return(l,o)=>($(),X(Vt))}},It="/assets/poddle_logo_complete-55ed4d1e.png";const xt=H({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function kt(e){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:o}=l;let n=0;const a=R(null),t=E(0),c=E(0),v=E(0),h=E(!1),w=E(!1),f=m(()=>Number(e.scrollThreshold)),L=m(()=>De((f.value-t.value)/f.value||0)),S=()=>{const _=a.value;!_||o&&!o.value||(n=t.value,t.value="window"in _?_.pageYOffset:_.scrollTop,w.value=t.value<n,v.value=Math.abs(t.value-f.value))};return K(w,()=>{c.value=c.value||t.value}),K(h,()=>{c.value=0}),oe(()=>{K(()=>e.scrollTarget,_=>{var p;const V=_?document.querySelector(_):window;V&&V!==a.value&&((p=a.value)==null||p.removeEventListener("scroll",S),a.value=V,a.value.addEventListener("scroll",S,{passive:!0}))},{immediate:!0})}),he(()=>{var _;(_=a.value)==null||_.removeEventListener("scroll",S)}),o&&K(o,S,{immediate:!0}),{scrollThreshold:f,currentScroll:t,currentThreshold:v,isScrollActive:h,scrollRatio:L,isScrollingUp:w,savedScroll:c}}const Ct=H({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...dt(),...mt(),...xt(),height:{type:[Number,String],default:64}},"VAppBar"),Lt=Z()({name:"VAppBar",props:Ct(),emits:{"update:modelValue":e=>!0},setup(e,l){let{slots:o}=l;const n=R(),a=He(e,"modelValue"),t=m(()=>{var r;const u=new Set(((r=e.scrollBehavior)==null?void 0:r.split(" "))??[]);return{hide:u.has("hide"),inverted:u.has("inverted"),collapse:u.has("collapse"),elevate:u.has("elevate"),fadeImage:u.has("fade-image")}}),c=m(()=>{const u=t.value;return u.hide||u.inverted||u.collapse||u.elevate||u.fadeImage||!a.value}),{currentScroll:v,scrollThreshold:h,isScrollingUp:w,scrollRatio:f}=kt(e,{canScroll:c}),L=m(()=>e.collapse||t.value.collapse&&(t.value.inverted?f.value>0:f.value===0)),S=m(()=>e.flat||t.value.elevate&&(t.value.inverted?v.value>0:v.value===0)),_=m(()=>t.value.fadeImage?t.value.inverted?1-f.value:f.value:void 0),V=m(()=>{var M,j;if(t.value.hide&&t.value.inverted)return 0;const u=((M=n.value)==null?void 0:M.contentHeight)??0,r=((j=n.value)==null?void 0:j.extensionHeight)??0;return u+r});Ue(m(()=>!!e.scrollBehavior),()=>{Ne(()=>{t.value.hide?t.value.inverted?a.value=v.value>h.value:a.value=w.value||v.value<h.value:a.value=!0})});const{ssrBootStyles:p}=xe(),{layoutItemStyles:i}=pt({id:e.name,order:m(()=>parseInt(e.order,10)),position:ae(e,"location"),layoutSize:V,elementSize:E(void 0),active:a,absolute:ae(e,"absolute")});return J(()=>{const[u]=me.filterProps(e);return s(me,qe({ref:n,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...i.value,"--v-toolbar-image-opacity":_.value,height:void 0,...p.value},e.style]},u,{collapse:L.value,flat:S.value}),o)}),{}}}),Tt=e=>(We("data-v-b759727e"),e=e(),je(),e),Bt={class:"logoContainer"},At={class:"buttonWrapper"},zt={class:"buttonWrapper"},Mt={class:"buttonWrapper"},Rt={key:0,class:"buttonWrapper"},Et={key:1,class:"buttonWrapper"},$t=Tt(()=>B("br",null,null,-1)),Dt={__name:"AppBar",setup(e){let l=R(!1),o=R(""),n=R(""),a=R(""),t=R(!1);const c=()=>{l.value=!1,o.value="",n.value=""},v=async()=>{t.value=!1;const p=await x.auth.getSession();if(p.data.session!==null)try{await x.from("favorites").delete("*").eq("user_email",p.data.session.user.email),await x.from("last_played_tracks").delete("*").eq("user_email",p.data.session.user.email),L(),console.log("Cleared history")}catch(i){console.error("Error clearing history:",i)}};(async()=>{const{data:p}=await x.auth.getSession();p.session===null?(a.value=!1,console.log("logged out")):(a.value=!0,console.log("logged in"))})();const w=async()=>{if(l.value=!1,a.value===!1&&(l.value=!0),a.value===!0){const{error:p}=await x.auth.signOut();p?console.log(p):(alert("Logout successful"),a.value=!1,_(),L())}},f=async()=>{l.value=!1;const{data:p,error:i}=await x.auth.signInWithPassword({email:o.value,password:n.value});i?console.log(i):(console.log(p),a.value=!0,V(),alert("Login successful"))},L=()=>{S.value={showId:null,showTitle:null,episodeTitle:null,episode:null,season:null,file:null,timePlayed:0}};window.addEventListener("beforeunload",_);const{currentlyPlaying:S}=Ve(Ie());async function _(){const p=await x.auth.getSession();if(p.data.session!==null){const i=S.value;try{const{data:u,error:r}=await x.from("last_played_tracks").insert({user_email:p.data.session.user.email,time_added:new Date,showId:i.showId,show_title:i.showTitle,episode_title:i.episodeTitle,episode:i.episode,season:i.season,file:i.file,time_played:i.timePlayed});r?console.error("Error inserting data:",r.message):console.log("Data inserted successfully:",u)}catch(u){console.error("Error inserting data:",u.message)}}}async function V(){if((await x.auth.getSession()).data.session!==null){const i=await x.auth.getSession(),u=S.value;try{const{data:r,error:M}=await x.from("last_played_tracks").select("*").eq("user_email",i.data.session.user.email).order("time_added",{ascending:!1}).limit(1);if(r.length>0)u.showId=r[0].showId,u.showTitle=r[0].show_title,u.episodeTitle=r[0].episode_title,u.episode=r[0].episode,u.season=r[0].season,u.file=r[0].file,u.timePlayed=r[0].time_played;else if(M){console.error("Error fetching data:",M.message);return}else{console.log("No data for played tracks");return}}catch(r){console.error("Error fetching data:",r.message)}}}return oe(()=>{V()}),(p,i)=>{const u=Pe("router-link");return $(),G(Oe,null,[s(Lt,{flat:"",image:"https://images.unsplash.com/photo-1550684848-fac1c5b4e853?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80"},{default:d(()=>[B("div",Bt,[s(ut,{class:"logoImage",src:It})]),B("nav",null,[B("div",At,[s(C,{variant:"elevated",size:"small","prepend-icon":"mdi-home"},{default:d(()=>[s(u,{to:"/"},{default:d(()=>[I("Home")]),_:1})]),_:1})]),B("div",zt,[s(C,{variant:"elevated",size:"small","prepend-icon":"mdi-playlist-music"},{default:d(()=>[s(u,{to:"/browse"},{default:d(()=>[I("Browse")]),_:1})]),_:1})]),B("div",Mt,[s(C,{variant:"elevated",size:"small","prepend-icon":"mdi-account"},{default:d(()=>[I(" My Account "),s(Ke,{activator:"parent"},{default:d(()=>[s(Ge,null,{default:d(()=>[s(ce,null,{default:d(()=>[s(C,{variant:"text",block:"",size:"small","prepend-icon":"mdi-heart"},{default:d(()=>[s(u,{to:"/favorites"},{default:d(()=>[I("Go to my favorites")]),_:1})]),_:1})]),_:1}),s(ce,null,{default:d(()=>[s(C,{onClick:i[0]||(i[0]=r=>U(t)?t.value=!0:t=!0),variant:"text",block:"",size:"small","prepend-icon":"mdi-delete-sweep"},{default:d(()=>[I(" Clear Listening History ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),z(a)?($(),G("div",Rt,[s(C,{color:"purple",variant:"elevated",size:"small",onClick:w},{default:d(()=>[s(u,{to:"/"},{default:d(()=>[I("Logout")]),_:1})]),_:1})])):($(),G("div",Et,[s(C,{color:"purple",variant:"elevated",size:"small",onClick:w},{default:d(()=>[I("Login")]),_:1})]))])]),_:1}),s(pe,{modelValue:z(l),"onUpdate:modelValue":i[3]||(i[3]=r=>U(l)?l.value=r:l=r),width:"50%"},{default:d(()=>[s(de,null,{default:d(()=>[s(ve,null,{default:d(()=>[I("Log in to Poddle Account")]),_:1}),B("form",null,[s(fe,{modelValue:z(o),"onUpdate:modelValue":i[1]||(i[1]=r=>U(o)?o.value=r:o=r),label:"E-mail"},null,8,["modelValue"]),s(fe,{modelValue:z(n),"onUpdate:modelValue":i[2]||(i[2]=r=>U(n)?n.value=r:n=r),label:"Password"},null,8,["modelValue"]),s(C,{class:"me-4",onClick:c},{default:d(()=>[I("Cancel")]),_:1}),s(C,{class:"me-4",color:"primary",onClick:f},{default:d(()=>[I("Login")]),_:1})])]),_:1})]),_:1},8,["modelValue"]),s(pe,{class:"clearHistoryDialog",modelValue:z(t),"onUpdate:modelValue":i[5]||(i[5]=r=>U(t)?t.value=r:t=r),width:"25%"},{default:d(()=>[s(de,null,{default:d(()=>[s(ve,null,{default:d(()=>[I("Confirm clear listening history")]),_:1}),s(ct,null,{default:d(()=>[I("This will remove all your favorites and recorded timestamps of any episodes you have listened to. Are you sure you want to proceed?")]),_:1}),$t,s(C,{class:"dialogButton",onClick:i[4]||(i[4]=r=>U(t)?t.value=!1:t=!1)},{default:d(()=>[I("Cancel")]),_:1}),s(C,{class:"dialogButton",color:"primary",onClick:v},{default:d(()=>[I("Confirm")]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Ht=Se(Dt,[["__scopeId","data-v-b759727e"]]);const Ut=H({scrollable:Boolean,...se(),...ke({tag:"main"})},"VMain"),qt=Z()({name:"VMain",props:Ut(),setup(e,l){let{slots:o}=l;const{mainStyles:n}=ft(),{ssrBootStyles:a}=xe();return J(()=>s(e.tag,{class:["v-main",{"v-main--scrollable":e.scrollable},e.class],style:[n.value,a.value,e.style]},{default:()=>{var t,c;return[e.scrollable?s("div",{class:"v-main__scroller"},[(t=o.default)==null?void 0:t.call(o)]):(c=o.default)==null?void 0:c.call(o)]}})),{}}}),Nt={__name:"MainView",setup(e){return(l,o)=>{const n=Pe("router-view");return $(),X(qt,null,{default:d(()=>[s(n)]),_:1})}}};const Ot=H({...se(),...vt({fullHeight:!0}),...we()},"VApp"),Wt=Z()({name:"VApp",props:Ot(),setup(e,l){let{slots:o}=l;const n=be(e),{layoutClasses:a,layoutStyles:t,getLayoutItem:c,items:v,layoutRef:h}=gt(e),{rtlClasses:w}=Fe();return J(()=>{var f;return s("div",{ref:h,class:["v-application",n.themeClasses.value,a.value,w.value,e.class],style:[t.value,e.style]},[s("div",{class:"v-application__wrap"},[(f=o.default)==null?void 0:f.call(o)])])}),{getLayoutItem:c,items:v,theme:n}}}),Jt={__name:"DefaultLayout",setup(e){return(l,o)=>($(),X(Wt,null,{default:d(()=>[s(Ht),s(Nt),s(Pt)]),_:1}))}};export{Jt as default};
