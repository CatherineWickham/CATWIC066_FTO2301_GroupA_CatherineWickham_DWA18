import{_ as S,v as C,r as y,w as u,z as w,$ as I,x as g,y as r,A as D,B as h,u as s,L as _,C as d,N as k,D as F,M as U,a as x,c as B,K as L,O as q,P as E}from"./index-60f7ff30.js";import{u as P}from"./VMenu-ec599dc0.js";import{E as M,V as $,s as N,y as R,t as Z,q as T,r as z}from"./VCard-ba4fbd38.js";import{V,a as O,L as H}from"./LoadingIndicator-b03dcd89.js";import{V as K}from"./VForm-6f524c26.js";import{V as Y}from"./VToolbar-d540fa48.js";import{V as A}from"./VContainer-f69f8121.js";import"./VTextField-bcce73b8.js";const b=M("flex-grow-1","div","VSpacer");const j={class:"favImage"},G={class:"favInfo"},J={class:"text"},Q={class:"actions"},W={key:1,class:"removed"},X={__name:"FavoritesList",props:["sortedFavoritesData"],setup(p){const m=p,{currentlyPlaying:l}=C(P());let n=y(0);const c=async t=>{const o=await F.auth.getSession();try{await F.from("favorites").update({is_favorite:!t.isFavorite}).eq("user_email",o.data.session.user.email).eq("showId",t.showId).eq("season",t.season).eq("episode",t.episode),console.log("Updated existing fav in database"),t.isFavorite=!t.isFavorite,n.value++}catch(e){console.error("Error removing favorite:",e)}},v=t=>(l.value.showId=t.showId,l.value.showTitle=t.showTitle,l.value.episodeTitle=t.episodeTitle,l.value.episode=t.episode,l.value.file=t.file,l.value.timePlayed=t.timePlayed,console.log(l.value),l.value);return(t,o)=>(u(!0),w(k,null,I(m.sortedFavoritesData,e=>(u(),g(z,{width:"100%",key:e.id},{default:r(()=>[e.isFavorite?(u(),w("div",{class:"favContainer",key:D(n)},[h("div",j,[s($,{src:e.image,width:"200",cover:""},null,8,["src"])]),h("div",G,[h("div",J,[s(N,null,{default:r(()=>[_(d(e.showTitle+" - Season "+e.season),1)]),_:2},1024),s(R,null,{default:r(()=>[_(d(e.episodeTitle+" - Episode "+e.episode),1)]),_:2},1024),s(Z,null,{default:r(()=>[_(d(e.episodeDescription),1)]),_:2},1024),s(V,null,{default:r(()=>[_(" LAST UPDATED: "+d(new Date(e.lastUpdated).getDate().toString().padStart(2,"0"))+"/ "+d((new Date(e.lastUpdated).getMonth()+1).toString().padStart(2,"0"))+"/ "+d(new Date(e.lastUpdated).getFullYear()),1)]),_:2},1024),s(V,null,{default:r(()=>[_(" ADDED TO FAVORITES: "+d(new Date(e.dateAdded).getDate().toString().padStart(2,"0"))+"/ "+d((new Date(e.dateAdded).getMonth()+1).toString().padStart(2,"0"))+"/ "+d(new Date(e.dateAdded).getFullYear())+" "+d(new Date(e.dateAdded).getHours())+":"+d(new Date(e.dateAdded).getMinutes()),1)]),_:2},1024)]),h("div",Q,[s(T,{class:"actionButton",icon:"mdi-play",size:"large",color:"purple",variant:"outlined",onClick:i=>v(e),"data-key":e.id},null,8,["onClick","data-key"]),s(T,{class:"actionButton",icon:"mdi-close",variant:"tonal",size:"large",onClick:i=>c(e),"data-key":e.id},null,8,["onClick","data-key"])])])])):(u(),w("div",W,"Favorite removed"))]),_:2},1024))),128))}},ee=S(X,[["__scopeId","data-v-5fad6b78"]]);const te={__name:"FavoritesToolbar",emits:["filtersApplied"],setup(p,{emit:m}){let l=["Unsorted","Alphabetical (A to Z)","Alphabetical (Z to A)","Date updated (earliest first)","Date updated (latest first)"],n=y("Unsorted");const c=v=>{v.preventDefault();const t={sortType:n.value};m("filtersApplied",t)};return(v,t)=>(u(),g(Y,null,{default:r(()=>[s(b),s(K,{onSubmit:c},{default:r(()=>[s(O,{class:"formItem",modelValue:D(n),"onUpdate:modelValue":t[0]||(t[0]=o=>U(n)?n.value=o:n=o),label:"Sort By",items:D(l)},null,8,["modelValue","items"]),s(T,{class:"formItem",type:"submit",variant:"outlined"},{default:r(()=>[_("Apply Filters")]),_:1})]),_:1}),s(b)]),_:1}))}},ae=S(te,[["__scopeId","data-v-74b0c672"]]);const se=p=>(q("data-v-5d7a297d"),p=p(),E(),p),oe=se(()=>h("div",{class:"bottomSpacer"},null,-1)),le={__name:"FavoritesView",setup(p){let m=y(!1),l=x([]);(async()=>{const o=await F.auth.getSession();try{let e=[],{data:i}=await F.from("favorites").select("*").eq("user_email",o.data.session.user.email).eq("is_favorite",!0);for(const a of i)e.push({id:a.id,showId:a.showId,showTitle:a.show_name,season:a.season,dateAdded:a.date_added,lastUpdated:a.last_updated,episode:a.episode,episodeTitle:a.episode_title,episodeDescription:a.episode_description,image:a.season_image,timePlayed:a.time_played,file:a.file,isFavorite:!0});l.value=e,m.value=!0}catch(e){console.error(e)}})();let c=y("Unsorted");const v=o=>{const{sortType:e}=o;c.value=e},t=B(()=>{let o=[...l.value];return c.value==="Alphabetical (A to Z)"?o.sort((e,i)=>{let a=e.showTitle.toLowerCase(),f=i.showTitle.toLowerCase();return a<f?-1:a>f?1:0}):c.value==="Alphabetical (Z to A)"?o.sort((e,i)=>{let a=e.showTitle.toLowerCase(),f=i.showTitle.toLowerCase();return a>f?-1:a<f?1:0}):c.value==="Date updated (latest first)"?o.sort((e,i)=>new Date(i.lastUpdated).getTime()-new Date(e.lastUpdated).getTime()):c.value==="Date updated (earliest first)"&&o.sort((e,i)=>new Date(e.lastUpdated).getTime()-new Date(i.lastUpdated).getTime()),o});return(o,e)=>{const i=L("router-link");return u(),w(k,null,[s(ae,{class:"toolbar",onFiltersApplied:v}),s(T,{class:"backButton",variant:"tonal","append-icon":"mdi-arrow-u-left-bottom"},{default:r(()=>[s(i,{to:"/browse"},{default:r(()=>[_("Back to Browse")]),_:1})]),_:1}),D(m)?(u(),g(A,{key:0,fluid:"",class:"fill-height"},{default:r(()=>[s(ee,{sortedFavoritesData:t.value},null,8,["sortedFavoritesData"]),oe]),_:1})):(u(),g(A,{key:1,class:"loadingContainer"},{default:r(()=>[s(H)]),_:1}))],64)}}},me=S(le,[["__scopeId","data-v-5d7a297d"]]);export{me as default};
